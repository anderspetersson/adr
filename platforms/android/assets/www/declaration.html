<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Ratchet template page</title>

    <!-- Sets initial viewport load and disables zooming  -->
    <meta name="viewport" content="initial-scale=1, maximum-scale=1">

    <!-- Makes your prototype chrome-less once bookmarked to your phone's home screen -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <!-- Include the compiled Ratchet CSS -->
    <link href="css/ratchet.css" rel="stylesheet">
    <script type="text/javascript" src="js/jquery-2.1.3.min.js"></script>

  </head>
  <body>


    <!-- Make sure all your bars are the first things in your <body> -->
    <header class="bar bar-nav">
      <a class="icon icon-left-nav pull-left" href="index.html"></a>
      <h1 class="title">Godsdeklaration</h1>
    </header>

    <nav class="bar bar-tab">
      <a class="tab-item" href="index.html">
        <span class="icon icon-bars"></span>
        <span class="tab-label">Ã„mnen</span>
      </a>
      <a class="tab-item active" href="declaration.html">
        <span class="icon icon-compose"></span>
        <span class="tab-label">Deklaration</span>
      </a>
      <a class="tab-item" href="#">
        <span class="icon icon-star-filled"></span>
        <span class="tab-label">Favorites</span>
      </a>
      <a class="tab-item" href="#">
        <span class="icon icon-gear"></span>
        <span class="tab-label">Settings</span>
      </a>
    </nav>

    <!-- Wrap all non-bar HTML in the .content div (this is actually what scrolls) -->
    <div class="content">
        <ul class="table-view">
        <script class="js-custom">
          id = getURLParameter('id');
          $.getJSON( "http://10.0.1.4:8000/api/substances/" + id + "/?format=json", function( data ) {
            $('.title').text(data.title);
          });
          window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, gotFS, fail);

          function gotFS(fileSystem) {
              fileSystem.root.getFile("test2.txt", null, gotFileEntry, fail);
          }

          function gotFileEntry(fileEntry) {
              fileEntry.file(gotFile, fail);
          }

          function gotFile(file){
              readAsText(file);
          }

          function readAsText(file) {
              var reader = new FileReader();
              reader.onloadend = function(evt) {
                  json = JSON.parse(evt.target.result);
                  $.each( json, function( key, val ) {
                    line = 'UN ' + val.un + ' ' + val.description + ', ' + val.class_code + ', ' + val.tunnel_code;
                    line += ' Antal: ' + val.number;
                    li = $('<li/>').addClass('table-view-cell').text(line);
                    $('.table-view').append(li);
                  });

              };
              reader.readAsText(file);
          }

          function fail(error) {
              console.log(error.code);
          }
        </script>
    </div>

  </body>
</html>
